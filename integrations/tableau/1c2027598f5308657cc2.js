(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{109:function(e,t,a){"use strict";a.r(t);var i=a(0),s=a.n(i),o=a(88),n=a(93),l=a(95);const r=Object(l.a)();t.default=function(){return s.a.createElement(o.a,{api:r},s.a.createElement(n.a,null))}},88:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return u}));var i=a(86),s=a(0),o=a.n(s),n=a(27),l=a(2),r=a(90),c=a(89);class h extends r.a{constructor(){super(...arguments),this._dataTable=null,this._dataTablePromise=new Promise(()=>null),this._selectionDataTables=null,this._selectionDataTablesPromise=new Promise(()=>null),this.combinationsOptions={type:"intersection",min:1,max:5,empty:!1,limit:100,order:["cardinality","name"]},this.hover=null,this.selection=null,this.attributeFields=[],this.state="init",this.isViewMode=!1,this.worksheet=""}init(e){super.init(e),this.attributeFields=e.attributeFields,this.isViewMode=e.isViewingMode,this.worksheet=e.worksheet,this.regenerate()}handleUpdates(e){super.handleUpdates(e),e.has("attributeFields")&&(this.attributeFields=this.api.attributeFields),(e.has("dataSource")||e.has("worksheet")||e.has("nameField")||e.has("setFields")||e.has("attributeFields"))&&this.regenerate()}regenerate(){const e=this.api;if(this.worksheet&&e.offSelectionChanged(this.setSelectionDataTables),this.worksheet=e.worksheet,this._dataTable=null,this._selectionDataTables=null,!e.dataSource||!e.nameField||0===e.setFields.length||!e.worksheet)return this.state="config",this._dataTablePromise=Promise.resolve(null),void(this._selectionDataTablesPromise=Promise.resolve([]));this.state="loading",this._dataTablePromise=e.getUnderlyingData(e.worksheet,e.dataSource,[e.nameField,...e.setFields,...e.attributeFields].filter(Boolean)),this._dataTablePromise.then(e=>this.setDataTable(e)),this._selectionDataTablesPromise=e.getSelectedMarks(e.worksheet),this._selectionDataTablesPromise.then(e=>this.setSelectionDataTables(e)),e.onSelectionChanged(e.worksheet,this.setSelectionDataTables)}get elems(){const e=this.dataTable;if(!e)return[];const t=e.columns.find(e=>e.fieldName===this.api.nameField);if(!t)return[];const a=this.api.attributeFields.map(t=>e.columns.find(e=>e.fieldName===t)).filter(e=>null!=e),i=t.index;return e.data.map(e=>{const t=e[i].formattedValue,s={};return a.forEach(t=>{s[t.fieldName]=e[t.index].value}),{name:t,attrs:s}})}get selectedElems(){const e=this.selectionDataTables;if(0===e.length)return[];const t=this.api.nameField,a=e.find(e=>null!=e.columns.find(e=>e.fieldName===t));if(!a)return[];const i=a.columns.find(e=>e.fieldName===t).index,s=new Set(a.data.map(e=>e[i].formattedValue));return this.elems.filter(e=>s.has(e.name))}get sets(){const e=this.dataTable;if(!e)return[];const t=this.api.setFields.map(t=>e.columns.find(e=>e.fieldName===t)).filter(e=>null!=e);if(0===t.length)return[];const a=this.elems;return t.map(t=>Object(c.a)({name:t.fieldName,elems:a.filter((a,i)=>function(e){if("boolean"==typeof e)return e;if("number"==typeof e)return 0!==e;const t=String(e).toLowerCase();return"1"===t||"true"===t||"t"===t||"yes"===t}(e.data[i][t.index].value))}))}get combinations(){return Object(c.c)(this.sets,Object.assign({elems:this.elems},this.combinationsOptions))}setDataTable(e){this.state=e?"ready":"config",this._dataTable=e}setSelectionDataTables(e){this._selectionDataTables=e,console.log(this._selectionDataTables)}setHover(e){this.hover=e}setSelection(e){this.selection=e,this.api.setSelectedMarks(this.worksheet,this.api.nameField,e?e.elems.map(e=>e.name):[])}get dataTable(){if(this._dataTable)return this._dataTable;throw this._dataTablePromise}get selectionDataTables(){if(this._selectionDataTables)return this._selectionDataTables;throw this._selectionDataTablesPromise}}Object(i.b)([l.f.ref],h.prototype,"_dataTable",void 0),Object(i.b)([l.f.ref],h.prototype,"_dataTablePromise",void 0),Object(i.b)([l.f.ref],h.prototype,"_selectionDataTables",void 0),Object(i.b)([l.f.ref],h.prototype,"_selectionDataTablesPromise",void 0),Object(i.b)([l.f],h.prototype,"combinationsOptions",void 0),Object(i.b)([l.f.ref],h.prototype,"hover",void 0),Object(i.b)([l.f.ref],h.prototype,"selection",void 0),Object(i.b)([l.f],h.prototype,"attributeFields",void 0),Object(i.b)([l.f],h.prototype,"state",void 0),Object(i.b)([l.f],h.prototype,"isViewMode",void 0),Object(i.b)([l.c],h.prototype,"elems",null),Object(i.b)([l.c],h.prototype,"selectedElems",null),Object(i.b)([l.c],h.prototype,"sets",null),Object(i.b)([l.c],h.prototype,"combinations",null),Object(i.b)([l.b],h.prototype,"setDataTable",null),Object(i.b)([l.b.bound],h.prototype,"setSelectionDataTables",null),Object(i.b)([l.b.bound],h.prototype,"setHover",null),Object(i.b)([l.b.bound],h.prototype,"setSelection",null);const b=o.a.createContext(null),d=({api:e,children:t})=>{const a=Object(n.c)(()=>new h(e));return o.a.createElement(b.Provider,{value:a}," ",t," ")},u=()=>{const e=o.a.useContext(b);if(!e)throw new Error("useStore must be used within a StoreProvider.");return e}},93:function(e,t,a){"use strict";var i=a(0),s=a.n(i),o=a(13),n=a(28),l=a(27),r=a(88),c=a(96),h=a(97),b=a(14);const d=Object(o.c)({root:{flexGrow:1,overflow:"hidden"},upset:{position:"absolute"}}),u={chartLabel:"13px",setLabel:"13px"},m=Object(l.a)(({width:e,height:t})=>{const a=Object(r.b)(),i=a.ui.dark?b.a:b.b,o=a.selectedElems,n=a.hover?a.hover:0===o.length?void 0:o,l=o.length>0?i.highlighted:i.primary,h=a.hover?i.hover:i.primary;return s.a.createElement(c.a,{id:"u",theme:a.ui.theme,sets:a.sets,combinations:a.combinations,width:e,height:t,fontSizes:u,className:d.upset,color:l,textColor:i.text,alternatingBackgroundColor:"rgba(0, 0, 0, 0.05)",selectionColor:h,fontFamily:!1,selection:n,onHover:a.setHover,onClick:a.setSelection})});function p({width:e,height:t}){return e>0&&t>0?s.a.createElement(i.Suspense,{fallback:"loading"},s.a.createElement(m,{width:e,height:t})):s.a.createElement("svg",{className:d.upset})}var f=Object(l.a)(()=>s.a.createElement("div",{className:d.root},s.a.createElement(h.a,{handleHeight:!0,handleWidth:!0,render:p})));const g=Object(o.c)({root:{flexGrow:1,position:"relative",display:"flex",flexDirection:"column",justifyContent:"center"},click:{alignSelf:"center"}});t.a=Object(l.a)(()=>{const e=Object(r.b)(),t=Object(i.useCallback)(()=>e.api.openDialog(),[e]);return s.a.createElement("div",{className:g.root},"loading"===e.state||"ready"===e.state&&s.a.createElement(f,null),"config"===e.state&&!e.isViewMode&&s.a.createElement(n.Button,{className:g.click,onClick:t,kind:e.ui.button},"Configure"),"init"===e.state&&s.a.createElement(n.Spinner,{className:g.click,color:e.ui.theme}))})}}]);