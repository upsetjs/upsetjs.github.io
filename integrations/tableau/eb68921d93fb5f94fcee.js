(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{106:function(e,t,a){"use strict";a.r(t);var i=a(0),s=a.n(i),r=a(87),l=a(92),n=a(94);const d=Promise.resolve(new n.a);t.default=function(){return s.a.createElement(r.a,{api:d},s.a.createElement(l.a,null))}},86:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));function i(e,t,a,i){var s,r=arguments.length,l=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,a):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,i);else for(var n=e.length-1;n>=0;n--)(s=e[n])&&(l=(r<3?s(l):r>3?s(t,a,l):s(t,a))||l);return r>3&&l&&Object.defineProperty(t,a,l),l}function s(e,t,a,i){return new(a||(a=Promise))((function(s,r){function l(e){try{d(i.next(e))}catch(e){r(e)}}function n(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(l,n)}d((i=i.apply(e,t||[])).next())}))}},87:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return b}));var i=a(86),s=a(0),r=a.n(s),l=a(27),n=a(2),d=a(90);class o extends d.a{constructor(){super(...arguments),this.selectedTabIndex=0,this._dataSources=null,this.draggedField=null,this.draggedPosition={x:0,y:0},this.draggedFieldRef=Object(s.createRef)(),this.worksheets=[],this._dataSourcesPromise=new Promise(()=>null),this.dataSource="",this.worksheet="",this.nameField="",this.setFields=[],this.attributeFields=[],this.state="init"}init(e){super.init(e),this.state="loading",this.nameField=e.nameField,this.setFields=e.setFields,this.attributeFields=e.attributeFields,this.worksheet=e.worksheet,this.dataSource=e.dataSource,this.worksheets=e.getWorksheets(),this._dataSourcesPromise=e.getDataSources(e.worksheet),this._dataSourcesPromise.then(e=>this.setDataSources(e))}setDataSources(e){this.state="ready",this._dataSources=e,this.dataSource||1!==e.length||(this.dataSource=e[0].id,this.api.dataSource=e[0].id)}setDraggedField(e,t={x:0,y:0}){this.draggedField=e,this.draggedPosition=t}get dataSources(){if(this._dataSources)return this._dataSources;throw this._dataSourcesPromise}get fields(){if(!this._dataSources)return[];const e=this._dataSources.find(e=>this.dataSource===e.id);return e?e.fields.filter(e=>!e.isHidden&&!e.isGenerated):[]}handleUpdates(e){super.handleUpdates(e),e.has("dataSource")&&(this.dataSource=this.api.dataSource),e.has("nameField")&&(this.nameField=this.api.nameField),e.has("setFields")&&(this.setFields=this.api.setFields),e.has("attributeFields")&&(this.attributeFields=this.api.attributeFields)}changeWorksheet(e){this.worksheet=e,this.api.worksheet=e,this.changeDataSource(""),this._dataSourcesPromise=this.api.getDataSources(e),this._dataSourcesPromise.then(e=>this.setDataSources(e))}changeDataSource(e){this.dataSource=e,this.nameField="",this.setFields=[],this.attributeFields=[],this.api.dataSource=this.dataSource,this.api.nameField=this.nameField,this.api.setFields=this.setFields,this.api.attributeFields=this.attributeFields}setSelectedTabIndex(e){this.selectedTabIndex=e}get measures(){return this.fields.filter(e=>"measure"===e.role)}get dimensions(){return this.fields.filter(e=>"dimension"===e.role)}get valid(){return""!==this.nameField&&this.setFields.length>0}setNameField(e){this.nameField=e,this.api.nameField=e}toggleSetField(e,t){const a=this.setFields.includes(e);a!==t&&(a?this.setFields.splice(this.setFields.indexOf(e),1):this.setFields.push(e),this.api.setFields=this.setFields)}toggleAttributeField(e,t){const a=this.attributeFields.includes(e);a!==t&&(a?this.attributeFields.splice(this.attributeFields.indexOf(e),1):this.attributeFields.push(e),this.api.attributeFields=this.attributeFields)}}Object(i.b)([n.f],o.prototype,"selectedTabIndex",void 0),Object(i.b)([n.f.shallow],o.prototype,"_dataSources",void 0),Object(i.b)([n.f.ref],o.prototype,"draggedField",void 0),Object(i.b)([n.f],o.prototype,"draggedPosition",void 0),Object(i.b)([n.f.shallow],o.prototype,"worksheets",void 0),Object(i.b)([n.f.ref],o.prototype,"_dataSourcesPromise",void 0),Object(i.b)([n.f.ref],o.prototype,"dataSource",void 0),Object(i.b)([n.f.ref],o.prototype,"worksheet",void 0),Object(i.b)([n.f],o.prototype,"nameField",void 0),Object(i.b)([n.f],o.prototype,"setFields",void 0),Object(i.b)([n.f],o.prototype,"attributeFields",void 0),Object(i.b)([n.f],o.prototype,"state",void 0),Object(i.b)([n.b],o.prototype,"setDataSources",null),Object(i.b)([n.b],o.prototype,"setDraggedField",null),Object(i.b)([n.c],o.prototype,"fields",null),Object(i.b)([n.b],o.prototype,"changeWorksheet",null),Object(i.b)([n.b],o.prototype,"changeDataSource",null),Object(i.b)([n.b.bound],o.prototype,"setSelectedTabIndex",null),Object(i.b)([n.c],o.prototype,"measures",null),Object(i.b)([n.c],o.prototype,"dimensions",null),Object(i.b)([n.c],o.prototype,"valid",null),Object(i.b)([n.b],o.prototype,"setNameField",null),Object(i.b)([n.b],o.prototype,"toggleSetField",null),Object(i.b)([n.b],o.prototype,"toggleAttributeField",null);const c=r.a.createContext(null),u=({api:e,children:t})=>{const a=Object(l.c)(()=>new o(e));return r.a.createElement(c.Provider,{value:a}," ",t," ")},b=()=>{const e=r.a.useContext(c);if(!e)throw new Error("useStore must be used within a StoreProvider.");return e}},92:function(e,t,a){"use strict";var i=a(0),s=a.n(i),r=a(27),l=a(13),n=a(28),d=a(87),o=a(14);const c=Object(l.b)({flex:"1 1 0",minHeight:"2.5em",overflow:"auto",border:"1px solid #E6E6E6",borderRadius:"5px",position:"relative",$nest:{"& > div":{position:"absolute",width:"100%",boxSizing:"border-box",display:"flex",flexDirection:"column",alignItems:"start",padding:"0.5em"}}}),u=Object(l.c)({root:{display:"flex",position:"relative",overflow:"hidden",$nest:{[`&[data-type=measure] .${c}[data-type=measure], &[data-type=dimension] .${c}[data-type=dimension]`]:{borderColor:o.b.action},[`&[data-type=measure] .${c}[data-type=measure]:hover, &[data-type=dimension] .${c}[data-type=dimension]:hover`]:{background:"#F5F5F5"},[`&[data-theme=dark][data-type=measure] .${c}[data-type=measure]:hover, &[data-type=dimension] .${c}[data-type=dimension]:hover`]:{background:"#F5F5F5"},"&[data-type]":{cursor:"grabbing !important"}}},header:{margin:"0.5em 0"},side:{flex:"1 1 0",display:"flex",flexDirection:"column",marginRight:"0.5em"},target:{flex:"1 1 0",display:"flex",flexDirection:"column",marginLeft:"0.5em"},error:{borderColor:o.b.attention},pill:{cursor:"grab",width:"15em",textOverflow:"ellipsis",margin:"2px"},dragged:{pointerEvents:"none",position:"absolute",left:0,top:0},grabbing:{cursor:"grabbing"},elems:{flexGrow:1},sets:{flexGrow:8},attributes:{flexGrow:3}}),b=Object(r.a)(({field:e,schema:t})=>{const a=Object(d.b)(),r=Object(i.useCallback)(t=>{if(0!==t.button)return;const i=t.currentTarget,s=i.closest("."+u.root);s.dataset.type=i.dataset.type;const r=s.getBoundingClientRect();a.setDraggedField(e,{x:t.clientX-r.x,y:t.clientY-r.y})},[a,e]);return s.a.createElement(n.Pill,{kind:"dimension"===e.role?"discrete":"continuous",schema:t,"data-id":e.id,"data-type":e.role,className:u.pill,onMouseDown:r},e.name)}),m=Object(r.a)(()=>{const e=Object(d.b)(),t=e.draggedField;return t?s.a.createElement(n.Pill,{style:{transform:`translate(${e.draggedPosition.x}px,${e.draggedPosition.y}px)`},ref:e.draggedFieldRef,kind:"dimension"===t.role?"discrete":"continuous","data-id":t.id,"data-type":t.role,className:Object(l.a)(u.pill,u.dragged)},t.name):null});var h=Object(r.a)(()=>{var e;const t=Object(d.b)(),a=Object(i.useCallback)(e=>t.changeDataSource(e.target.value),[t]),r=Object(i.useCallback)(e=>t.changeWorksheet(e.target.value),[t]),o=Object(i.useCallback)(e=>{delete e.currentTarget.dataset.type,t.setDraggedField(null)},[t]),h=Object(i.useCallback)(()=>{if(!t.draggedField)return;const e=t.draggedField.id;t.toggleSetField(e,!1),t.nameField===e&&t.setNameField("")},[t]),p=Object(i.useCallback)(()=>{if(!t.draggedField)return;const e=t.draggedField.id;t.toggleAttributeField(e,!1)},[t]),g=Object(i.useCallback)(()=>{if(!t.draggedField)return;const e=t.draggedField.id;t.setNameField(e)},[t]),f=Object(i.useCallback)(()=>{if(!t.draggedField)return;const e=t.draggedField.id;t.toggleSetField(e,!0)},[t]),F=Object(i.useCallback)(()=>{if(!t.draggedField)return;const e=t.draggedField.id;t.toggleAttributeField(e,!0)},[t]),y=Object(i.useCallback)(e=>{if(!t.draggedFieldRef.current)return;const a=e.currentTarget.getBoundingClientRect(),i=e.clientX-a.x,s=e.clientY-a.y;t.draggedFieldRef.current.style.transform=`translate(${i}px, ${s}px)`},[t]);return s.a.createElement("div",{className:u.root,"data-theme":t.ui.theme,onMouseMove:y,onMouseUp:o,onMouseLeave:o},s.a.createElement("div",{className:u.side},s.a.createElement("h4",{className:u.header},"Associated Worksheet"),s.a.createElement("div",{className:u.root},t.worksheets.map(e=>s.a.createElement(n.Radio,{key:e.name,value:e.name,onChange:r,checked:e.name===t.worksheet},e.name))),t.worksheet&&t.dataSources&&t.dataSources.length>1&&s.a.createElement(s.a.Fragment,null,s.a.createElement("h4",{className:u.header},"Data Sources"),s.a.createElement("div",{className:u.root},(null!==(e=t.dataSources)&&void 0!==e?e:[]).map(e=>s.a.createElement(n.Radio,{key:e.id,value:e.id,onChange:a,checked:e.id===t.dataSource},e.name)))),s.a.createElement("h5",{className:u.header},"Dimensions"),s.a.createElement("div",{className:Object(l.a)(c,u.sets),"data-type":"dimension",onMouseUp:h},s.a.createElement("div",null,t.dimensions.filter(e=>t.nameField!==e.id&&!t.setFields.includes(e.id)).map(e=>s.a.createElement(b,{key:e.id,field:e,schema:!0})))),s.a.createElement("h5",{className:u.header},"Measures"),s.a.createElement("div",{className:Object(l.a)(c,u.attributes),"data-type":"measure",onMouseUp:p},s.a.createElement("div",null,t.measures.filter(e=>!t.attributeFields.includes(e.id)).map(e=>s.a.createElement(b,{key:e.id,field:e,schema:!0}))))),s.a.createElement("div",{className:u.target},s.a.createElement("h4",{className:u.header},"Mapped Data"),s.a.createElement("h5",{className:u.header},"Elements (exactly 1)"),s.a.createElement("div",{className:Object(l.a)(c,u.elems,!t.nameField&&u.error),"data-type":"dimension",onMouseUp:g},s.a.createElement("div",null,t.dimensions.filter(e=>t.nameField===e.id).map(e=>s.a.createElement(b,{key:e.id,field:e})))),s.a.createElement("h5",{className:u.header},"Sets (one or more)"),s.a.createElement("div",{className:Object(l.a)(c,u.sets,0===t.setFields.length&&u.error),"data-type":"dimension",onMouseUp:f},s.a.createElement("div",null,t.dimensions.filter(e=>t.setFields.includes(e.id)).map(e=>s.a.createElement(b,{key:e.id,field:e})))),s.a.createElement("h5",{className:u.header},"Attributes"),s.a.createElement("div",{className:Object(l.a)(c,u.attributes),"data-type":"measure",onMouseUp:F},s.a.createElement("div",null,t.measures.filter(e=>t.attributeFields.includes(e.id)).map(e=>s.a.createElement(b,{key:e.id,field:e}))))),s.a.createElement(m,null))});const p=Object(l.c)({root:{}});var g=Object(r.a)(()=>{const e=Object(d.b)();return s.a.createElement("div",{className:p.root},s.a.createElement(n.TextField,{label:"Set Axis",value:e.dataSource}))});const f=Object(l.c)({root:{flexGrow:1,display:"flex",flexDirection:"column"},grow:{flexGrow:1},buttonBar:{display:"flex",justifyContent:"center",$nest:{"& > *":{marginRight:"1em"}}},tabs:{flex:"1 1 0",display:"flex",flexDirection:"column",$nest:{"& > [role=tabpanel]":{flex:"1 1 0",display:"flex"},"& > [role=tabpanel] > *":{flex:"1 1 0"}}}}),F=Object(r.a)(()=>{const e=Object(d.b)();return s.a.createElement(s.a.Fragment,null,"init"===e.state||"loading"===e.state&&s.a.createElement(n.Spinner,{color:e.ui.theme}),"ready"===e.state&&s.a.createElement(i.Suspense,{fallback:s.a.createElement(n.Spinner,{color:e.ui.theme})},0===e.selectedTabIndex&&s.a.createElement(h,null),1===e.selectedTabIndex&&s.a.createElement(g,null)))});t.a=Object(r.a)(()=>{const e=Object(d.b)(),t=Object(i.useCallback)(()=>e.api.save(),[e]),a=Object(i.useCallback)(()=>e.api.closeDialog(!1),[e]),r=Object(i.useCallback)(()=>e.api.closeDialog(),[e]);return s.a.createElement("div",{className:f.root},s.a.createElement(n.Tabs,{className:f.tabs,selectedTabIndex:e.selectedTabIndex,onTabChange:e.setSelectedTabIndex,activation:"automatic",alignment:"justified",tabs:[{title:"Data",content:"Data"},{title:"Style",content:"Style"}]},s.a.createElement(F,null)),s.a.createElement("div",{className:f.buttonBar},s.a.createElement(n.Button,{onClick:t,kind:e.ui.button,disabled:!e.valid},"Save Changes"),s.a.createElement(n.Button,{onClick:r,kind:e.ui.button,disabled:!e.valid},"Save Changes and Close"),s.a.createElement(n.Button,{onClick:a,kind:e.ui.button},"Cancel")))})}}]);